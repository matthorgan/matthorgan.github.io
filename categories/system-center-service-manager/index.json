[
    {
        "ref": "https://matthorgan.xyz/blog/register-datawarehouse/",
        "title": "Register-SCDWSource Cmdlet hidden parameter",
        "section": "blog",
        "tags": ["powershell","automation","service manager","system center"],
        "date" : "2018.08.01",
        "body": "Myself and a colleague were recently given the task of end-to-end automation of Sytem Center Service Manager using PowerShell DSC. This needed to include prerequisites, installation of the product, and any post configuration.\nIf any of you are familiar with Service Manager, you\u0026rsquo;ll know that one of the steps is to register Service Manager to the data warehouse. Luckily, there\u0026rsquo;s a PowerShell cmdlet for that which should make the task a breeze: Register-SCDWSource\nLooking at the documentation, I\u0026rsquo;ve modified Microsoft\u0026rsquo;s example to use my credentials and VM names to register the datawarehouse with Service Manager:\n$creds = New-Object -TypeName \u0026#39;PSCredential\u0026#39; -ArgumentList (\u0026#39;lab\\Administrator\u0026#39;, (ConvertTo-SecureString -String \u0026#39;MyLabPassword\u0026#39; -AsPlainText -Force)) Register-SCDWSource -ComputerName \u0026#39;scsmdw1\u0026#39; -SourceComputerName \u0026#39;scsmms1\u0026#39; -DataSourceTypeName \u0026#39;ServiceManager\u0026#39; -Credential $creds When you run this command, a credential request pop-up box appears which would imply that the $creds variable hasn\u0026rsquo;t worked hence the prompt. Looking back at the example online, there\u0026rsquo;s nothing obvious missed and the $creds variable contains a credential object as you\u0026rsquo;d expect.\nUpon cancelling the prompt pop-up box, things started becoming clear:\nI should have paid more attention to the initial message behind the pop-up box - the -Credential parameter and $creds variable were working exactly as expected BUT the Register-SCDWSource cmdlet actually required the SourceCredential parameter too. I tried to use the auto-complete functionality for the SourceCredential parameter but nothing was coming up (and nothing was mentioned about this parameter in the documentation) which filled me with 0% confidence. However, I ended up trying it and to my shock, the cmdlet worked a treat:\n$creds = New-Object -TypeName \u0026#39;PSCredential\u0026#39; -ArgumentList (\u0026#39;lab\\Administrator\u0026#39;, (ConvertTo-SecureString -String \u0026#39;MyLabPassword\u0026#39; -AsPlainText -Force)) Register-SCDWSource -ComputerName \u0026#39;scsmdw1\u0026#39; -SourceComputerName \u0026#39;scsmms1\u0026#39; -DataSourceTypeName \u0026#39;ServiceManager\u0026#39; -Credential $creds -SourceCredential $creds A great lesson here is that we\u0026rsquo;re all human and even Microsoft are going to make mistakes with their documentation and cmdlets. Hopefully the feedback will ensure that they update the documentation and if not then, hopefully this post helps!\n"
    }
]
