<!DOCTYPE html>
<html>
  <head>
  <title>
      
          Register-SCDWSource Cmdlet hidden parameter - Matt&#39;s Blog
      
  </title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content="Matt Horgan" />
  <link rel="shortcut icon" type="image/x-icon" href="https://matthorgan.xyz/img/favicon.ico">

  
  
  
  
  
  <link rel="stylesheet" href="https://matthorgan.xyz/style.min.39acacc5d2051426f655a6b7fbf4786fbd0fd8fffd09322c9b497ef0f7439b3f.css" integrity="sha256-OaysxdIFFCb2Vaa3&#43;/R4b70P2P/9CTIsm0l&#43;8PdDmz8=">
  
  
  
  <link rel="stylesheet" href="https://matthorgan.xyz/style-dark.min.0a647fb6c07e04b77b54fa0515d0a683d39ecdb251dba960fe1f966f7ff36fc2.css" media="(prefers-color-scheme: dark)" integrity="sha256-CmR/tsB&#43;BLd7VPoFFdCmg9OezbJR26lg/h&#43;Wb3/zb8I=">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">

  
  

  <meta property="og:title" content="Register-SCDWSource Cmdlet hidden parameter" />
<meta property="og:description" content="Myself and a colleague were recently given the task of end-to-end automation of Sytem Center Service Manager using PowerShell DSC. This needed to include prerequisites, installation of the product, and any post configuration.
If any of you are familiar with Service Manager, you&rsquo;ll know that one of the steps is to register Service Manager to the data warehouse. Luckily, there&rsquo;s a PowerShell cmdlet for that which should make the task a breeze: Register-SCDWSource" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://matthorgan.xyz/blog/register-datawarehouse/" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2018-08-01T00:00:00+00:00" />
<meta property="article:modified_time" content="2018-08-01T00:00:00+00:00" />
<meta itemprop="name" content="Register-SCDWSource Cmdlet hidden parameter">
<meta itemprop="description" content="Myself and a colleague were recently given the task of end-to-end automation of Sytem Center Service Manager using PowerShell DSC. This needed to include prerequisites, installation of the product, and any post configuration.
If any of you are familiar with Service Manager, you&rsquo;ll know that one of the steps is to register Service Manager to the data warehouse. Luckily, there&rsquo;s a PowerShell cmdlet for that which should make the task a breeze: Register-SCDWSource"><meta itemprop="datePublished" content="2018-08-01T00:00:00+00:00" />
<meta itemprop="dateModified" content="2018-08-01T00:00:00+00:00" />
<meta itemprop="wordCount" content="316">
<meta itemprop="keywords" content="powershell,automation,service manager,system center," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:image" content="https://matthorgan.xyz/img/avatar.jpg"/>
<meta name="twitter:title" content="Register-SCDWSource Cmdlet hidden parameter"/>
<meta name="twitter:description" content="Myself and a colleague were recently given the task of end-to-end automation of Sytem Center Service Manager using PowerShell DSC. This needed to include prerequisites, installation of the product, and any post configuration.
If any of you are familiar with Service Manager, you&rsquo;ll know that one of the steps is to register Service Manager to the data warehouse. Luckily, there&rsquo;s a PowerShell cmdlet for that which should make the task a breeze: Register-SCDWSource"/>

  <!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
  <![endif]-->

  <!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
  <![endif]-->

  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-112770718-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  
</head>

  <body>
    
  <h1>Register-SCDWSource Cmdlet hidden parameter</h1>
  <header>
  
  <div class="avatar">
    <img class="avatarMask" src="https://matthorgan.xyz/img/avatar.jpg" alt="">
    <a href="https://matthorgan.xyz"><img class="avatar-border" src="https://matthorgan.xyz/img/avatar-border.svg" alt=""></a>
  </div>
  
  <h2><a class="author" href="https://matthorgan.xyz">Matt Horgan</a></h2>
</header>

  
  
  
  <p class="date">August 1, 2018</p>
  
  
  
  <div id="tags">
    <ul>
      
        
        
          <li><a href="https://matthorgan.xyz/tags/powershell/">powershell</a></li>
        
      
        
        
          <li><a href="https://matthorgan.xyz/tags/automation/">automation</a></li>
        
      
        
        
          <li><a href="https://matthorgan.xyz/tags/service-manager/">service manager</a></li>
        
      
        
        
          <li><a href="https://matthorgan.xyz/tags/system-center/">system center</a></li>
        
      
    </ul>
  </div>
  
  
  <div id="contentBody">
    <p>Myself and a colleague were recently given the task of end-to-end automation of Sytem Center Service Manager using
PowerShell DSC. This needed to include prerequisites, installation of the product, and any post configuration.</p>
<p>If any of you are familiar with Service Manager, you&rsquo;ll know that one of the steps is to register Service Manager to the
data warehouse. Luckily, there&rsquo;s a PowerShell cmdlet for that which should make the task a breeze: <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.enterprisemanagement.warehouse.cmdlets/register-scdwsource?view=systemcenter-ps-2016">Register-SCDWSource</a></p>
<p>Looking at the documentation, I&rsquo;ve modified Microsoft&rsquo;s example to use my credentials and VM names to register the datawarehouse with Service Manager:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>$creds = New-Object -TypeName <span style="color:#e6db74">&#39;PSCredential&#39;</span> -ArgumentList (<span style="color:#e6db74">&#39;lab\Administrator&#39;</span>, (ConvertTo-SecureString -String <span style="color:#e6db74">&#39;MyLabPassword&#39;</span> -AsPlainText -Force))
</span></span><span style="display:flex;"><span>Register-SCDWSource -ComputerName <span style="color:#e6db74">&#39;scsmdw1&#39;</span> -SourceComputerName <span style="color:#e6db74">&#39;scsmms1&#39;</span> -DataSourceTypeName <span style="color:#e6db74">&#39;ServiceManager&#39;</span> -Credential $creds
</span></span></code></pre></div><p>When you run this command, a credential request pop-up box appears which would imply that the $creds variable hasn&rsquo;t worked hence the prompt. Looking back
at the example online, there&rsquo;s nothing obvious missed and the $creds variable contains a credential object as you&rsquo;d expect.</p>
<p><img src="https://matthorgan.xyz/img/cred_popup1.PNG" alt=""></p>
<p>Upon cancelling the prompt pop-up box, things started becoming clear:</p>
<p><img src="https://matthorgan.xyz/img/cred_popup2.PNG" alt=""></p>
<p>I should have paid more attention to the initial message behind the pop-up box - the -Credential parameter and $creds variable
were working exactly as expected BUT the <code>Register-SCDWSource</code> cmdlet actually required the <code>SourceCredential</code> parameter too.
I tried to use the auto-complete functionality for the <code>SourceCredential</code> parameter but nothing was coming up (and nothing was mentioned about this parameter in the documentation) which filled me with 0% confidence. However, I ended up trying it and to my shock, the cmdlet worked a treat:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>$creds = New-Object -TypeName <span style="color:#e6db74">&#39;PSCredential&#39;</span> -ArgumentList (<span style="color:#e6db74">&#39;lab\Administrator&#39;</span>, (ConvertTo-SecureString -String <span style="color:#e6db74">&#39;MyLabPassword&#39;</span> -AsPlainText -Force))
</span></span><span style="display:flex;"><span>Register-SCDWSource -ComputerName <span style="color:#e6db74">&#39;scsmdw1&#39;</span> -SourceComputerName <span style="color:#e6db74">&#39;scsmms1&#39;</span> -DataSourceTypeName <span style="color:#e6db74">&#39;ServiceManager&#39;</span> -Credential $creds -SourceCredential $creds
</span></span></code></pre></div><p>A great lesson here is that we&rsquo;re all human and even Microsoft are going to make mistakes with their documentation and cmdlets. Hopefully the feedback will ensure that they update the documentation and if not then, hopefully this post helps!</p>

  </div>
  <footer>
  <p>
  &copy; 2020 Matt Horgan.
  Powered by <a href="https://gohugo.io/">Hugo</a>
  using the <a href="https://github.com/koirand/pulp/">pulp</a> theme.
  </p>
</footer>


  </body>
</html>
