<!DOCTYPE html>
<html>
  <head>
  <title>
      
          PowerShell DSC ResourceKey Empty - Matt&#39;s Blog
      
  </title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content="Matt Horgan" />
  <link rel="shortcut icon" type="image/x-icon" href="https://matthorgan.xyz/img/favicon.ico">

  
  
  
  
  
  <link rel="stylesheet" href="https://matthorgan.xyz/style.min.39acacc5d2051426f655a6b7fbf4786fbd0fd8fffd09322c9b497ef0f7439b3f.css" integrity="sha256-OaysxdIFFCb2Vaa3&#43;/R4b70P2P/9CTIsm0l&#43;8PdDmz8=">
  
  
  
  <link rel="stylesheet" href="https://matthorgan.xyz/style-dark.min.0a647fb6c07e04b77b54fa0515d0a683d39ecdb251dba960fe1f966f7ff36fc2.css" media="(prefers-color-scheme: dark)" integrity="sha256-CmR/tsB&#43;BLd7VPoFFdCmg9OezbJR26lg/h&#43;Wb3/zb8I=">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">

  
  

  <meta property="og:title" content="PowerShell DSC ResourceKey Empty" />
<meta property="og:description" content="I&rsquo;m absolutely loving PowerShell DSC at the moment and we&rsquo;re using it heavily for the automation and configuration of various products. One of the most recent tasks was to create a fully parameterised SQL build function for reusability across the company. All was going swimmingly until I ran into the following error when attempting to run my freshly parameterised DSC function:
After a little bit of digging, I stumbled across a great blog post by Jacob Benson which had some nice troubleshooting steps (Link here)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://matthorgan.xyz/blog/powershell-dsc-resourcekey-empty/" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2018-01-04T00:00:00+00:00" />
<meta property="article:modified_time" content="2018-01-04T00:00:00+00:00" />
<meta itemprop="name" content="PowerShell DSC ResourceKey Empty">
<meta itemprop="description" content="I&rsquo;m absolutely loving PowerShell DSC at the moment and we&rsquo;re using it heavily for the automation and configuration of various products. One of the most recent tasks was to create a fully parameterised SQL build function for reusability across the company. All was going swimmingly until I ran into the following error when attempting to run my freshly parameterised DSC function:
After a little bit of digging, I stumbled across a great blog post by Jacob Benson which had some nice troubleshooting steps (Link here)."><meta itemprop="datePublished" content="2018-01-04T00:00:00+00:00" />
<meta itemprop="dateModified" content="2018-01-04T00:00:00+00:00" />
<meta itemprop="wordCount" content="338">
<meta itemprop="keywords" content="powershell,automation,dsc,sql," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:image" content="https://matthorgan.xyz/img/avatar.jpg"/>
<meta name="twitter:title" content="PowerShell DSC ResourceKey Empty"/>
<meta name="twitter:description" content="I&rsquo;m absolutely loving PowerShell DSC at the moment and we&rsquo;re using it heavily for the automation and configuration of various products. One of the most recent tasks was to create a fully parameterised SQL build function for reusability across the company. All was going swimmingly until I ran into the following error when attempting to run my freshly parameterised DSC function:
After a little bit of digging, I stumbled across a great blog post by Jacob Benson which had some nice troubleshooting steps (Link here)."/>

  <!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
  <![endif]-->

  <!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
  <![endif]-->

  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-112770718-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  
</head>

  <body>
    
  <h1>PowerShell DSC ResourceKey Empty</h1>
  <header>
  
  <div class="avatar">
    <img class="avatarMask" src="https://matthorgan.xyz/img/avatar.jpg" alt="">
    <a href="https://matthorgan.xyz"><img class="avatar-border" src="https://matthorgan.xyz/img/avatar-border.svg" alt=""></a>
  </div>
  
  <h2><a class="author" href="https://matthorgan.xyz">Matt Horgan</a></h2>
</header>

  
  
  
  <p class="date">January 4, 2018</p>
  
  
  
  <div id="tags">
    <ul>
      
        
        
          <li><a href="https://matthorgan.xyz/tags/powershell/">powershell</a></li>
        
      
        
        
          <li><a href="https://matthorgan.xyz/tags/automation/">automation</a></li>
        
      
        
        
          <li><a href="https://matthorgan.xyz/tags/dsc/">dsc</a></li>
        
      
        
        
          <li><a href="https://matthorgan.xyz/tags/sql/">sql</a></li>
        
      
    </ul>
  </div>
  
  
  <div id="contentBody">
    <p>I&rsquo;m absolutely loving PowerShell DSC at the moment and we&rsquo;re using it heavily for the automation and configuration of various products. One of the most recent tasks was to create a fully parameterised SQL build function for reusability across the company. All was going swimmingly until I ran into the following error when attempting to run my freshly parameterised DSC function:</p>
<p><img src="https://matthorgan.xyz/img/initial_dsc_error.PNG" alt=""></p>
<p>After a little bit of digging, I stumbled across a great blog post by Jacob Benson which had some nice troubleshooting steps (<a href="http://jacobbenson.com/?p=735#sthash.zRNaYRyN.dpbs">Link here</a>). This blog pointed me in the right direction - the key property of the DSC resource always has to be present. Well, weirdly, all of my parameters were being correctly passed through because I&rsquo;d verified that in a verbose message:</p>
<p><img src="https://matthorgan.xyz/img/verified_parameters.PNG" alt=""></p>
<p>I had a quick look in the MOF file for the DSC resource I was using (SqlSetup in SqlServerDsc)and noted that the key was &lsquo;InstanceName&rsquo;. I then changed the InstanceName parameter to a hardcoded value and re-ran the configuration&hellip; BINGO! It worked absolutely fine which meant there must have been something wrong with my InstanceName parameter.</p>
<p>A DSC configuration will automatically have three default parameters when it is created - InstanceName, OutputPath, and ConfigurationData. After rolling back to a fresh snapshot in my lab, I decided to change the name of the parameter I was using for InstanceName because I&rsquo;d actually just called it $InstanceName for simplicity. I renamed it to $SqlInstanceName and re-ran the configuration and SQL installed like a charm.</p>
<p>I&rsquo;ve never had to use the default parameter &lsquo;InstanceName&rsquo; for any of my configurations so it took me a while to realise what was going wrong. However, when you think that any variables with the same names as default parameter names are going to be overwritten with the default parameter values, it makes perfect sense. The original error wasn&rsquo;t misleading at all - &lsquo;ResourceKey&rsquo; WAS an empty string and next time I&rsquo;ll be more careful with my function parameter names to ensure they don&rsquo;t clash with any DSC configuration default parameters.</p>

  </div>
  <footer>
  <p>
  &copy; 2020 Matt Horgan.
  Powered by <a href="https://gohugo.io/">Hugo</a>
  using the <a href="https://github.com/koirand/pulp/">pulp</a> theme.
  </p>
</footer>


  </body>
</html>
